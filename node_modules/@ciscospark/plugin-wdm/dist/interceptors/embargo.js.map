{"version":3,"sources":["../../src/interceptors/embargo.js"],"names":["EmbargoInterceptor","options","reason","statusCode","spark","device","clear","credentials","logger","info","reject"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKA;;;;AAEA;;;IAGqBA,kB;;;;;;;;;;;;AASnB;;;;;;oCAMgBC,O,EAASC,M,EAAQ;AAC/B,UAAIA,OAAOC,UAAP,KAAsB,GAA1B,EAA+B;AAC7B,aAAKC,KAAL,CAAWC,MAAX,CAAkBC,KAAlB;AACA,aAAKF,KAAL,CAAWG,WAAX,CAAuBD,KAAvB;AACA,aAAKF,KAAL,CAAWI,MAAX,CAAkBC,IAAlB;AACD;;AAED,aAAO,kBAAQC,MAAR,CAAeR,MAAf,CAAP;AACD;;;;AAtBD;;;6BAGgB;AACd;AACA,aAAO,IAAIF,kBAAJ,CAAuB,EAACI,OAAO,IAAR,EAAvB,CAAP;AACD;;;0BAjBH;;;;;kBAUqBJ,kB","file":"embargo.js","sourcesContent":["/**!\n *\n * Copyright (c) 2015-2016 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport {Interceptor} from '@ciscospark/http-core';\n\n/**\n * @class\n */\nexport default class EmbargoInterceptor extends Interceptor {\n  /**\n   * @returns {EmbargoInterceptor}\n   */\n  static create() {\n    /* eslint no-invalid-this: [0] */\n    return new EmbargoInterceptor({spark: this});\n  }\n\n  /**\n   * @see Interceptor#onResponseError\n   * @param {Object} options\n   * @param {Error} reason\n   * @returns {Promise}\n   */\n  onResponseError(options, reason) {\n    if (reason.statusCode === 451) {\n      this.spark.device.clear();\n      this.spark.credentials.clear();\n      this.spark.logger.info(`Received \\`HTTP 451 Unavailable For Legal Reasons\\`, discarding credentials and device registration`);\n    }\n\n    return Promise.reject(reason);\n  }\n}\n"]}